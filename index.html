
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Contador Épico</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      text-align: center;
      background: url('fortaleza_asediada.png') no-repeat center center fixed;
      background-size: cover;
      color: #eee;
      transition: background-image 1s ease;
    }
    #contador {
      font-size: 60px;
      margin: 20px 0;
      transition: transform 0.2s ease;
      background: rgba(0, 0, 0, 0.5);
      display: inline-block;
      padding: 10px 30px;
      border-radius: 10px;
    }
    .boton {
      font-size: 20px;
      margin: 5px;
      padding: 10px 20px;
      cursor: pointer;
      background: rgba(0, 0, 0, 0.7);
      color: #eee;
      border: 1px solid #555;
      border-radius: 8px;
      transition: transform 0.1s;
    }
    .boton:active {
      transform: scale(0.95);
    }
    #mensaje {
      position: relative;
      font-size: 50px;
      color: #ff3333;
      margin-top: 30px;
      display: none;
      animation: destello 2s infinite alternate;
      text-shadow: 2px 2px 5px black, 0 0 30px black;
      font-weight: bold;
    }
    @keyframes destello {
      0% { text-shadow: 2px 2px 5px black, 0 0 20px #ff3333; }
      100% { text-shadow: 2px 2px 5px black, 0 0 50px #ff3333; }
    }
    .relampago-svg {
      position: fixed;
      top: -100%;
      left: 50%;
      width: 20px;
      height: 600px;
      opacity: 0;
      transform: translateX(-50%);
      animation: caerRelampago 0.5s linear forwards;
      filter: drop-shadow(0 0 10px white);
      z-index: 999;
    }
    @keyframes caerRelampago {
      0% { top: -100%; opacity: 1; }
      80% { top: 60%; opacity: 1; }
      100% { top: 100%; opacity: 0; }
    }
    body.flash {
      background-color: white;
      transition: background-color 0.2s;
    }
    .fuego {
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 150px;
      height: 150px;
      background: url('fuego.gif') no-repeat center center;
      background-size: contain;
      z-index: 1000;
      display: none;
    }
  </style>
</head>
<body>

  <h1>Contador</h1>
  <div id="contador">0</div>
  <br>
  <button class="boton" data-cambio="1">+1</button>
  <button class="boton" data-cambio="5">+5</button>
  <button class="boton" data-cambio="-1">-1</button>
  <button class="boton" data-cambio="-5">-5</button>

  <div id="mensaje">¡ENEMIGO DERROTADO!</div>
  <div class="fuego" id="fuego"></div>

  <script>
    let valor = 0;
    let valorAnterior = 0;
    const contador = document.getElementById('contador');
    const mensaje = document.getElementById('mensaje');
    const fuego = document.getElementById('fuego');

    function actualizarContador(cambio) {
      valorAnterior = valor;
      valor = Math.min(100, Math.max(0, valor + cambio));
      contador.textContent = valor;
      contador.style.transform = 'scale(1.2)';
      setTimeout(() => contador.style.transform = 'scale(1)', 150);
      if (valor === 0 && valorAnterior > 0) {
        mostrarMensajeEpico();
      } else if (valor > 0) {
        mensaje.style.display = 'none';
        fuego.style.display = 'none';
        document.body.style.backgroundImage = "url('fortaleza_asediada.png')";
      }
    }

    function mostrarMensajeEpico() {
      mensaje.style.display = 'block';
      fuego.style.display = 'block';
      document.body.style.backgroundImage = "url('fortaleza_destruida.png')";
      lanzarRelampagos(3);
      destelloFondo();
    }

    function lanzarRelampagos(cantidad) {
      for (let i = 0; i < cantidad; i++) {
        setTimeout(() => {
          const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
          svg.setAttribute("viewBox", "0 0 100 300");
          svg.classList.add('relampago-svg');
          const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
          polyline.setAttribute("points", "50,0 40,60 60,100 45,160 55,200 50,300");
          polyline.setAttribute("stroke", "white");
          polyline.setAttribute("stroke-width", "2");
          polyline.setAttribute("fill", "none");
          svg.appendChild(polyline);
          svg.style.left = `${Math.random() * 90 + 5}%`;
          document.body.appendChild(svg);
          svg.addEventListener('animationend', () => svg.remove());
        }, i * 300);
      }
    }

    function destelloFondo() {
      document.body.classList.add('flash');
      setTimeout(() => document.body.classList.remove('flash'), 200);
    }

    document.querySelectorAll('.boton').forEach(boton => {
      boton.addEventListener('click', () => {
        const cambio = parseInt(boton.getAttribute('data-cambio'), 10);
        actualizarContador(cambio);
      });
    });
  </script>
</body>
</html>
